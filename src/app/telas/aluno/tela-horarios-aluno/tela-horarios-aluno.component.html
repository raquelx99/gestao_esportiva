<app-top-bar></app-top-bar>

<div class="horarios-aluno-page-container">
  <div class="ha-content-card">
    <header class="ha-header">
      <h2>Horários dos Espaços</h2>
    </header>

    <section class="mapa-espacos-container">
      <h3>Nossos Espaços</h3>
      <div class="mapa-grid-img">
        <a *ngFor="let espaco of listaDeEspacos"
           [routerLink]="[]" [fragment]="'espaco-detalhe-' + espaco.id"
           class="mapa-espaco-item-img">
          <figure class="mapa-espaco-figure">
            <img [src]="getImagemEspaco(espaco.nome)" [alt]="espaco.nome">
            <figcaption>{{ espaco.nome }}</figcaption>
          </figure>
        </a>
        <div *ngIf="listaDeEspacos.length === 0">
          <p>Nenhum espaço disponível no momento.</p>
        </div>
      </div>
    </section>

    <hr class="secao-divisor">

    <section class="detalhes-horarios-container">
      <div *ngFor="let espaco of listaDeEspacos" id="espaco-detalhe-{{espaco.id}}" class="espaco-detalhe-bloco-img">
        <div class="representacao-espaco-img">
          <img [src]="getImagemEspaco(espaco.nome)" [alt]="espaco.nome">
          <h4>{{ espaco.nome }}</h4>
        </div>
        <div class="tabela-horarios-aluno-wrapper">
          <table>
            <thead>
              <tr>
                <th>Período / Bloco</th>
                <th *ngFor="let dia of diasDaSemanaCabecalho">{{ dia }}</th>
              </tr>
            </thead>
            <tbody>
              <!-- Para cada período, filtra os slotsFixosPorPeriodo correspondentes -->
              <ng-container *ngFor="let periodo of ['Manhã','Tarde','Noite']">
                <!-- Linha cabeçalho de período -->
                <tr class="periodo-header-row">
                  <td [attr.colspan]="diasDaSemanaCabecalho.length + 1">{{ periodo }}</td>
                </tr>
                <!-- Para cada slot fixo daquele período -->
                <tr *ngFor="let slotFixo of slotsFixosPorPeriodo">
                  <td>{{ slotFixo.bloco }} ({{ slotFixo.descricao }})</td>
                  <td *ngFor="let diaNome of diasDaSemanaCabecalho"
                      [ngClass]="{
                        'slot-livre': getStatusSlot(espaco, diaNome, slotFixo.descricao) === 'Livre',
                        'slot-ocupado': getStatusSlot(espaco, diaNome, slotFixo.descricao) === 'Ocupado',
                        'slot-indisponivel': getStatusSlot(espaco, diaNome, slotFixo.descricao) === 'Indisponível'
                      }">
                    {{ getStatusSlot(espaco, diaNome, slotFixo.descricao) }}
                  </td>
                </tr>
              </ng-container>
            </tbody>
          </table>
        </div>
      </div>
      <div *ngIf="listaDeEspacos.length === 0">
        <p>Não há horários para exibir.</p>
      </div>
    </section>

  </div>
</div>