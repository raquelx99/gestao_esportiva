<app-top-bar></app-top-bar>

<div class="page-wrapper">
  <div class="visao-geral-container">

    <section class="card carteirinha-card">
      <h2>Carteira de acesso</h2>
      <div class="info-grid">
        <div><strong>Nome</strong><span>{{ usuarioNome }}</span></div>
        <div><strong>Matrícula</strong><span>{{ matricula }}</span></div>
        <div><strong>Curso</strong><span>{{ curso }}</span></div>
        <div><strong>Centro</strong><span>{{ centro }}</span></div>
        <div><strong>Telefone</strong><span>{{ telefone }}</span></div>
        <div><strong>Telefone urgência</strong><span>{{ telefoneUrgencia }}</span></div>
      </div>
      <div class="espacos-list">
        <strong>Espaços:</strong>
        <!-- CORREÇÃO: Usando um span para cada espaço para estilizar como pílula -->
        <span *ngFor="let espaco of espacosCarteirinha">{{ espaco }}</span>
      </div>
      <div class="rodape">
        <div class="semestre">
          <!-- Apenas um exemplo, ajuste se o formato for diferente -->
          {{ semestreInicioFormatted }}
        </div>
        <div class="validade" [class.expirada]="isExpired">
          Validade: {{ validadeFormatted }}
        </div>
      </div>
    </section>

    <section class="card horarios-card">
      <h2>Horários Livres</h2>
      <div class="dia">
        {{ nomeDoDiaAtual | titlecase }}
      </div>
      <table *ngIf="horariosAgrupados.length > 0; else semHorarios">
        <thead>
          <tr><th>Hora</th><th>Espaços</th></tr>
        </thead>
        <tbody>
          <!-- CORREÇÃO: Exibindo linha.intervalo em vez de linha.hora -->
          <tr *ngFor="let linha of horariosAgrupados">
            <td>{{ linha.intervalo }}</td>
            <td>{{ linha.espacos.join(', ') }}</td>
          </tr>
        </tbody>
      </table>
      <ng-template #semHorarios>
        <p class="no-data">Nenhum horário livre encontrado para hoje.</p>
      </ng-template>
    </section>

  </div>
</div>